(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[246],{2233:function(e,t,s){Promise.resolve().then(s.bind(s,9067)),Promise.resolve().then(s.bind(s,1211)),Promise.resolve().then(s.bind(s,8590)),Promise.resolve().then(s.t.bind(s,2972,23))},9067:function(e,t,s){"use strict";s.d(t,{CommentSection:function(){return u}});var r=s(7437),a=s(6070),n=s(2869),i=s(6818),c=s(6831),l=s(970),o=s(2265);let d=(0,s(9205).Z)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var x=s(8997),m=s(7648);function u(e){let{postId:t,currentUserId:s}=e,[u,h]=(0,o.useState)([]),[f,p]=(0,o.useState)(""),[g,v]=(0,o.useState)(!1),[y,j]=(0,o.useState)(!1),b=(0,l.e)();(0,o.useEffect)(()=>{N()},[t]);let N=async()=>{v(!0);try{let{data:e,error:s}=await b.from("comments").select("\n          id,\n          content,\n          like_count,\n          reply_count,\n          created_at,\n          profiles:user_id (\n            username,\n            display_name,\n            avatar_url\n          )\n        ").eq("post_id",t).is("parent_id",null).order("created_at",{ascending:!1});if(s)throw s;h((e||[]).map(e=>({...e,profiles:Array.isArray(e.profiles)?e.profiles[0]:e.profiles})))}catch(e){console.error("Error fetching comments:",e)}finally{v(!1)}},w=async e=>{if(e.preventDefault(),s&&f.trim()){j(!0);try{let{data:e,error:r}=await b.from("comments").insert({content:f.trim(),post_id:t,user_id:s}).select("\n          id,\n          content,\n          like_count,\n          reply_count,\n          created_at,\n          profiles:user_id (\n            username,\n            display_name,\n            avatar_url\n          )\n        ").single();if(r)throw r;h(t=>[{...e,profiles:Array.isArray(e.profiles)?e.profiles[0]:e.profiles},...t]),p("")}catch(e){console.error("Error posting comment:",e)}finally{j(!1)}}},_=e=>{let t=new Date,s=new Date(e),r=Math.floor((t.getTime()-s.getTime())/36e5);return r<1?"Just now":r<24?"".concat(r,"h"):r<168?"".concat(Math.floor(r/24),"d"):s.toLocaleDateString()};return(0,r.jsxs)(a.Zb,{className:"h-fit",children:[(0,r.jsx)(a.Ol,{children:(0,r.jsx)(a.ll,{className:"text-lg",children:"Comments"})}),(0,r.jsxs)(a.aY,{className:"space-y-4",children:[s&&(0,r.jsxs)("form",{onSubmit:w,className:"space-y-3",children:[(0,r.jsx)(i.g,{value:f,onChange:e=>p(e.target.value),placeholder:"Add a comment...",rows:3,maxLength:500}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[f.length,"/500"]}),(0,r.jsxs)(n.z,{type:"submit",size:"sm",disabled:y||!f.trim(),className:"bg-gradient-to-r from-rose-500 to-orange-500 hover:from-rose-600 hover:to-orange-600 text-white",children:[(0,r.jsx)(d,{className:"w-4 h-4 mr-2"}),y?"Posting...":"Post"]})]})]}),(0,r.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:g?(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:3}).map((e,t)=>(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full animate-pulse"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/4"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-3/4"})]})]},t))}):0===u.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("p",{children:"No comments yet."}),(0,r.jsx)("p",{className:"text-sm",children:"Be the first to share your thoughts!"})]}):u.map(e=>(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)(c.Avatar,{className:"h-8 w-8 flex-shrink-0",children:[(0,r.jsx)(c.AvatarImage,{src:e.profiles.avatar_url||"/placeholder.svg",alt:e.profiles.display_name}),(0,r.jsx)(c.AvatarFallback,{className:"bg-gradient-to-br from-rose-500 to-orange-500 text-white text-xs",children:e.profiles.display_name.charAt(0)})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)(m.default,{href:"/profile/".concat(e.profiles.username),className:"font-semibold text-sm text-gray-900 hover:underline",children:e.profiles.display_name}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:_(e.created_at)})]}),(0,r.jsx)("p",{className:"text-sm text-gray-700 text-pretty",children:e.content}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,r.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs text-gray-500 hover:text-red-600 p-0 h-auto",children:[(0,r.jsx)(x.Z,{className:"w-3 h-3 mr-1"}),e.like_count>0&&e.like_count]}),(0,r.jsx)(n.z,{variant:"ghost",size:"sm",className:"text-xs text-gray-500 p-0 h-auto",children:"Reply"})]})]})]},e.id))})]})]})}},8590:function(e,t,s){"use strict";s.d(t,{PostDetail:function(){return _}});var r=s(7437),a=s(6070),n=s(2869),i=s(6831),c=s(2265),l=s(7053),o=s(535),d=s(4508);let x=(0,o.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function m(e){let{className:t,variant:s,asChild:a=!1,...n}=e,i=a?l.g7:"span";return(0,r.jsx)(i,{"data-slot":"badge",className:(0,d.cn)(x({variant:s}),t),...n})}var u=s(970),h=s(8997);function f(e){let{postId:t,userId:s,initialLiked:a}=e,[i,l]=(0,c.useState)(a),[o,d]=(0,c.useState)(!1),x=(0,u.e)(),m=async()=>{d(!0);try{i?(await x.from("likes").delete().eq("user_id",s).eq("post_id",t),l(!1)):(await x.from("likes").insert({user_id:s,post_id:t}),l(!0))}catch(e){console.error("Error updating like:",e)}finally{d(!1)}};return(0,r.jsx)(n.z,{variant:"ghost",size:"sm",onClick:m,disabled:o,className:"".concat(i?"text-red-600 hover:text-red-700":"text-gray-600 hover:text-red-600"),children:(0,r.jsx)(h.Z,{className:"w-5 h-5 ".concat(i?"fill-current":"")})})}let p=(0,s(9205).Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);function g(e){let{postId:t}=e,s=async()=>{let e="".concat(window.location.origin,"/post/").concat(t);if(navigator.share)try{await navigator.share({title:"Check out this post on EDNA",url:e})}catch(e){console.log("Error sharing:",e)}else try{await navigator.clipboard.writeText(e)}catch(e){console.log("Error copying to clipboard:",e)}};return(0,r.jsx)(n.z,{variant:"ghost",size:"sm",onClick:s,className:"text-gray-600 hover:text-green-600",children:(0,r.jsx)(p,{className:"w-5 h-5"})})}var v=s(1178);function y(e){let{postId:t,userId:s}=e,[a,i]=(0,c.useState)(!1),[l,o]=(0,c.useState)(!1),d=(0,u.e)();(0,c.useEffect)(()=>{x()},[t,s]);let x=async()=>{let{data:e}=await d.from("saved_posts").select("id").eq("user_id",s).eq("post_id",t).single();i(!!e)},m=async()=>{o(!0);try{a?(await d.from("saved_posts").delete().eq("user_id",s).eq("post_id",t),i(!1)):(await d.from("saved_posts").insert({user_id:s,post_id:t}),i(!0))}catch(e){console.error("Error updating bookmark:",e)}finally{o(!1)}};return(0,r.jsx)(n.z,{variant:"ghost",size:"sm",onClick:m,disabled:l,className:"".concat(a?"text-yellow-600 hover:text-yellow-700":"text-gray-600 hover:text-yellow-600"),children:(0,r.jsx)(v.Z,{className:"w-5 h-5 ".concat(a?"fill-current":"")})})}var j=s(9337),b=s(2718),N=s(2208),w=s(7648);function _(e){let{post:t,currentUserId:s,hasLiked:c}=e,l=new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(0,r.jsxs)(a.Zb,{className:"overflow-hidden",children:[(0,r.jsx)("div",{className:"aspect-square relative",children:(0,r.jsx)("img",{src:t.image_url||"/placeholder.svg",alt:"Post content",className:"w-full h-full object-cover"})}),(0,r.jsxs)(a.aY,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,r.jsxs)(i.Avatar,{className:"h-12 w-12",children:[(0,r.jsx)(i.AvatarImage,{src:t.profiles.avatar_url||"/placeholder.svg",alt:t.profiles.display_name}),(0,r.jsx)(i.AvatarFallback,{className:"bg-gradient-to-br from-rose-500 to-orange-500 text-white",children:t.profiles.display_name.charAt(0)})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(w.default,{href:"/profile/".concat(t.profiles.username),className:"font-semibold text-gray-900 hover:underline",children:t.profiles.display_name}),t.profiles.is_verified&&(0,r.jsx)(j.Z,{className:"w-4 h-4 text-blue-500 fill-current"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["@",t.profiles.username]})]}),t.categories&&(0,r.jsx)(m,{style:{backgroundColor:t.categories.color},className:"text-white",children:t.categories.name})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("p",{className:"text-gray-700 text-pretty whitespace-pre-wrap",children:t.content})}),t.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:t.tags.map(e=>(0,r.jsx)(w.default,{href:"/tags/".concat(e.slug),children:(0,r.jsxs)(m,{variant:"secondary",className:"hover:bg-rose-100 hover:text-rose-700 cursor-pointer",children:["#",e.name]})},e.id))}),(0,r.jsxs)("div",{className:"flex items-center justify-between py-3 border-t border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(h.Z,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:[t.like_count," likes"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(b.Z,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:[t.comment_count," comments"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(N.Z,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:[t.view_count," views"]})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:l})]}),s&&(0,r.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(f,{postId:t.id,userId:s,initialLiked:c}),(0,r.jsx)(n.z,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-blue-600",asChild:!0,children:(0,r.jsx)(w.default,{href:"/post/".concat(t.id),children:(0,r.jsx)(b.Z,{className:"w-5 h-5"})})})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(g,{postId:t.id}),(0,r.jsx)(y,{postId:t.id,userId:s})]})]})]})]})}},6070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return l},Zb:function(){return n},aY:function(){return o},ll:function(){return c}});var r=s(7437);s(2265);var a=s(4508);function n(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function c(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...s})}function l(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...s})}function o(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...s})}},6818:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var r=s(7437);s(2265);var a=s(4508);function n(e){let{className:t,...s}=e;return(0,r.jsx)("textarea",{"data-slot":"textarea",className:(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}},9337:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},1178:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},2208:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},function(e){e.O(0,[972,338,964,430,211,971,117,744],function(){return e(e.s=2233)}),_N_E=e.O()}]);